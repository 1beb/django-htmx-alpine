{% if request.method == 'GET' %}

  <a id="login-captcha-audio-control"
     class="has-background-grey-lighter"
     tabindex="0">
    &#128264;
  </a>
  <audio id="login-captcha-audio"
         class="w-3rem h-1.5rem is-hidden"
         preload="none">
    <source src="{{ captcha_audio_url }}" type="audio/wav" />
  </audio>

  <img id="login-captcha-img"
       class="ml-1 captcha-img"
       src="{{ captcha_img_url }}"
       alt="CAPTCHA image">

  <input type="hidden"
         name="captcha_0"
         id="login-captcha-key"
         value="{{ captcha_key }}">

<script>
  let loginCaptchaAudio = document.querySelector('#login-captcha-audio');
  let loginCaptchaAudioControl =
    document.querySelector('#login-captcha-audio-control');

  loginCaptchaAudioControl.onclick = function() {
    // Update the Audio
    loginCaptchaAudio['play']();

      // Prevent Default Action
      return false;
  };
</script>


<style>
#login-captcha-audio-control {
  display: inline;
  padding: 0.5rem 0.25rem 0.5rem 0.65rem;
  border-radius: 0.5rem;
}
</style>


{% elif login_fail %}

  <span id="login-form-response-text"
        class="has-text-danger"
        x-data="{ show: false }"
        x-show="show"
        x-transition.opacity.duration.500ms
        x-init="$nextTick(() => {
          show = true;
          setTimeout(() => { show = false; }, defaultMessageTimeout);
        })">

    {{ form_errors }}

    <script>
      // get login captcha
      htmx.ajax('GET', '{% url 'users:login' %}', {
        target: '#login-captcha-img-container'
      });

      // re-enable the login submit button
      hDispatch('login-submit-button-enable');

    </script>

  </span>

{% elif login_success %}

  <span id="login-form-response-text"
        class="has-text-success"
        x-data="{ show: false }"
        x-show="show"
        x-transition.opacity.duration.500ms
        x-init="$nextTick(() => { show = true; })">
    Success!

    <script>
      // reload shortly after successful login
      setTimeout(() => { location.reload(); }, 1000)
    </script>

  </span>

{% endif %}

