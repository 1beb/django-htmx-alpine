<div class="status-message-notification-container">
  <div id="status-message-notification"
       class="has-background-info status-message-notification"
       @click="statusMessageClear"
       x-data="statusMessageNotification()"
       x-show.transition.opacity.duration.500ms="show"
       x-text="statusMessageText"
       x-cloak
       @status-message-display.window="receiveStatusMessageDisplay($event)">
  </div>
</div>


<script>
  function statusMessageNotification() {
    return {
      // data
      show: false,
      statusMessageText: '',
      statusMessageTimeout: undefined,

      // methods
      statusMessageDisplay(message, timeout=undefined) {
        // if a status message is already present,
        // then clear it and display a new one
        if (this.statusMessageText) {
          this.statusMessageClear();
          setTimeout(() => {
            this.statusMessageDisplay(message, timeout);
          }, 500);
          return false;
        }

        clearTimeout(this.statusMessageTimeout);
        if (timeout === undefined) {
          // if no timeout is given, display the message for 4 seconds
          timeout = 4000;
        } else if (timeout === -1) {
          // if timeout == -1, display the message forever
          timeout = 9999999;
        }

        this.show = true;
        this.statusMessageText = message;
        this.statusMessageTimeout = setTimeout(() => { this.statusMessageClear() }, timeout);
      },

      statusMessageClear() {
        clearTimeout(this.statusMessageTimeout);
        this.show = false;
        setTimeout(() => { this.statusMessageText = ''; }, 500)
      },

      receiveStatusMessageDisplay(event) {
        if (typeof(event.detail) === 'string') {
          this.statusMessageDisplay(event.detail);
        } else {
          this.statusMessageDisplay(event.detail.message, event.detail.timeout);
        }
      }
    }
  }
</script>


<style>

.status-message-notification-container {
  display: flex;
  position: fixed;
  top: 5rem;
  left: 0;
  width: 100vw;

  justify-content: center;
}

.status-message-notification {
  max-width: 30rem;

  padding: 0.75rem 1rem;

  font-size: 1.3rem;
  color: white;
  text-align: center;

  cursor: pointer;
  border: 1px solid black;
  border-radius: 0.5rem;
  z-index: 100;
}

</style>
