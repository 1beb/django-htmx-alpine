{% extends 'base.html' %}
{% load static %}

{% block title %}Your Todo List{% endblock %}
{% block body_title %}Your Todo List{% endblock %}

{% block content %}

<script type="text/javascript" src="{% static 'js/tasks.js' %}"></script>
<script>
  let taskCreateUrl = '{% url 'tasks:task_create' %}';
  let taskUpdateUrlNoId = '{% url 'tasks:task_update_no_id' %}';
  let taskDeleteUrlNoId = '{% url 'tasks:task_delete_no_id' %}';
</script>

<section x-data="todoList(
    taskCreateUrl, taskUpdateUrlNoId, taskDeleteUrlNoId)">

  <form class="mt-4 mx-auto is-flex is-justify-content-center"
        @submit.prevent="taskCreate()">
    <div class="field has-addons">
      <span class="control">
        <input type="text"
               x-ref="taskCreateInputDescription"
               class="input is-inline"
               placeholder="Enter new task..."
               data-cy="task-create-input-description">
      </span>
      <span class="control">
        <input type="submit"
               class="button is-info"
               value="Create"
               data-cy="task-create-button-confirm">
      </span>
    </div>
  </form>

  <!-- item delete modal -->
  <template x-if="taskDeleteModalIsActive">
    <div @keydown.escape.window="taskDeleteModalDisable"
         @keydown.tab.window="taskDeleteModalHandleTabEvent"></div>
  </template>

  <div class="modal is-active"
       x-show="taskDeleteModalIsActive"
       x-transition.opacity.duration.500ms
       x-cloak>
    <div class="modal-background"></div>
    <div class="w-max-25rem modal-content">

      <div @click.away="taskDeleteModalDisable"
           class="px-5 pt-2 pb-5 box is-flex is-flex-direction-column
                  is-justify-content-center is-align-items-center
                  has-text-centered">

        <div class="my-3 is-size-4">Delete Item</div>

        <div class="is-size-6 has-text-centered">
          Are you sure you want to delete this item?
        </div>

        <div class="mt-5 is-flex is-justify-content-space-between">
          <button x-ref="taskDeleteModalFirstTabbable"
                  class="button is-block is-danger is-medium is-fullwidth"
                  @click="taskDelete"
                  data-cy="task-button-delete">
            Delete
          </button>
          <button x-ref="taskDeleteModalLastTabbable"
                  class="ml-4 button is-block is-light is-medium is-fullwidth"
                  @click="taskDeleteModalDisable">
            Cancel
          </button>
        </div>

      </div>
    </div>
  </div>

  {% include 'tasks/list_tasks.html' %}

</section>

{% endblock content %}
